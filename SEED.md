# Database Seeding

–≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

## –ß—Ç–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ seeding

–°–∫—Ä–∏–ø—Ç `scripts/createMockUsers.mjs` —Å–æ–∑–¥–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ:

- **100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** —Å –ø—Ä–æ—Ñ–∏–ª—è–º–∏ (–∏–º—è, email, —Ñ–æ—Ç–æ, –±–∏–æ –∏ —Ç.–¥.)
- **300 –ø–æ—Å—Ç–æ–≤** (–ø–æ 3 –ø–æ—Å—Ç–∞ –Ω–∞ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- **500-1500 –ø–æ–¥–ø–∏—Å–æ–∫** –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- **~9000-21000 –ª–∞–π–∫–æ–≤** –Ω–∞ –ø–æ—Å—Ç—ã (30-70% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ª–∞–π–∫–∞—é—Ç –∫–∞–∂–¥—ã–π –ø–æ—Å—Ç)
- **600-2400 –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤** –∫ –ø–æ—Å—Ç–∞–º (2-8 –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –Ω–∞ –ø–æ—Å—Ç)
- **~6000-24000 –ª–∞–π–∫–æ–≤** –∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º (10-40% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- **~180-720 –æ—Ç–≤–µ—Ç–æ–≤** –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (30% –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏–º–µ—é—Ç –æ—Ç–≤–µ—Ç—ã)
- **30 —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤** —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- **150-450 —Å–æ–æ–±—â–µ–Ω–∏–π** –≤ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞—Ö
- **–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (notifications)** –¥–ª—è –≤—Å–µ—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π

---

## –ó–∞–ø—É—Å–∫ seed –≤ Docker

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ï—Å–ª–∏ –≤—ã —É–∂–µ –∑–∞–ø—É—Å—Ç–∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `docker-compose up`, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:

```bash
docker-compose exec app npm run seed:docker
```

**–í–∞–∂–Ω–æ:** –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –¥–æ–±–∞–≤–∏—Ç –¥–∞–Ω–Ω—ã–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º. –ï—Å–ª–∏ –±–∞–∑–∞ —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ, –æ–Ω–∏ –Ω–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ —Å –Ω–æ–≤–æ–π –±–∞–∑–æ–π

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –Ω–∞—á–∞—Ç—å —Å —á–∏—Å—Ç–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ volumes
docker-compose down -v

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
docker-compose up -d

# –î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏)
docker-compose logs -f app

# –ó–∞–ø—É—Å—Ç–∏—Ç—å seed
docker-compose exec app npm run seed:docker
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è seed

–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π —Å–µ—Ä–≤–∏—Å –≤ `docker-compose.yml` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

```yaml
services:
  # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã ...

  seed:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: social-app-seed
    environment:
      DATABASE_URL: postgresql://${POSTGRES_USER:-socialapp}:${POSTGRES_PASSWORD:-socialapp123}@postgres:5432/${POSTGRES_DB:-socialapp}?schema=public
      NODE_ENV: production
    depends_on:
      postgres:
        condition: service_healthy
    networks:
      - social-network
    command: npm run seed:docker
    profiles:
      - seed
```

–ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
docker-compose --profile seed up seed
```

---

## –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ Docker)

### –í–∞—Ä–∏–∞–Ω—Ç 1: Seed –±–µ–∑ —Å–±—Ä–æ—Å–∞ –±–∞–∑—ã

```bash
npm run seed
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –±–∞–∑—ã –∏ seed

```bash
npm run prisma:seed
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç:
1. `prisma migrate reset` - —Å–±—Ä–æ—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
2. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –º–∏–≥—Ä–∞—Ü–∏–π
3. –ó–∞–ø—É—Å–∫ seed —Å–∫—Ä–∏–ø—Ç–∞

---

## –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –í Docker:

```bash
docker compose exec app npm run list-users
```

### –õ–æ–∫–∞–ª—å–Ω–æ:

```bash
npm run list-users
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –ø–æ–∫–∞–∂–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å –ø–µ—Ä–≤—ã–º–∏ 20 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è seed –≤—ã —É–≤–∏–¥–∏—Ç–µ –≤—ã–≤–æ–¥:

```
üå± Starting database seeding...
üìù Creating users and posts...
‚úÖ Created 100 users with posts
üë• Creating follow relationships...
‚úÖ Created 500-1500 follow relationships
‚ù§Ô∏è  Creating post likes...
‚úÖ Created 9000-21000 post likes
üí¨ Creating comments...
‚úÖ Created 600-2400 comments
üëç Creating comment likes...
‚úÖ Created 6000-24000 comment likes
üí≠ Creating comment replies...
‚úÖ Created 180-720 comment replies
üíå Creating conversations and messages...
‚úÖ Created 30 conversations with 150-450 messages
üéâ Database seeding completed successfully!
```

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑–µ

### –ß–µ—Ä–µ–∑ Docker:

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ PostgreSQL
docker-compose exec postgres psql -U socialapp -d socialapp

# –í—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å—ã
SELECT COUNT(*) FROM "User";
SELECT COUNT(*) FROM "Post";
SELECT COUNT(*) FROM "Follow";
SELECT COUNT(*) FROM "Comment";
SELECT COUNT(*) FROM "PostLike";
SELECT COUNT(*) FROM "Message";
```

### –õ–æ–∫–∞–ª—å–Ω–æ (–µ—Å–ª–∏ –±–∞–∑–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ localhost:5433):

```bash
psql -h localhost -p 5433 -U socialapp -d socialapp
```

---

## –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

### –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –±–∞–∑—ã –≤ Docker:

```bash
docker-compose down -v
docker-compose up -d
```

### –õ–æ–∫–∞–ª—å–Ω–æ:

```bash
npm run prisma:seed
# –∏–ª–∏
npx prisma migrate reset
```

---

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "Can't reach database server"

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—É—â–µ–Ω–∞:

```bash
docker-compose ps
docker-compose logs postgres
```

### –û—à–∏–±–∫–∞: "Table does not exist"

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:

```bash
docker-compose exec app npx prisma migrate deploy
```

### Seed –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ

–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –°–æ–∑–¥–∞–Ω–∏–µ –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 2-5 –º–∏–Ω—É—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã.

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- –°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É `@faker-js/faker` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ê–≤–∞—Ç–∞—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ—Ä—É—Ç—Å—è –∏–∑ `seed-male-avatars` –∏ `seed-female-avatars`
- –í—Å–µ –¥–∞—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞ –¥–ª—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç–∏
- –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –¥—Ä—É–≥–æ–≥–æ)
